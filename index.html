<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mutant Records Store</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 2rem;
    }
    button {
      padding: 0.75rem 1.5rem;
      background-color: #66ff00;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      margin-top: 1rem;
    }
    input {
      padding: 0.5rem;
      width: 250px;
      margin-top: 1rem;
    }
    #badges {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 2rem;
      margin-top: 2rem;
    }
    .badge {
      width: 500px;
      height: 500px;
      background-color: #222;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #444;
      border-radius: 10px;
    }
    .badge.owned {
      background-color: #66ff00;
      color: #000;
      font-weight: bold;
      border-color: #66ff00;
    }
    .badge span {
      font-size: 1.5rem;
    }
    section {
      margin-top: 3rem;
    }
    .mint-card-container, .team-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 2rem;
    }
    .mint-card, .team-member {
      background: #111;
      padding: 1rem;
      border-radius: 10px;
      max-width: 300px;
    }
    .team-member img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body>
  <h1>Collectors Profile</h1>
  <button id="connectWalletBtn">Connect Wallet</button>
  <p id="walletAddress"></p>

  <section id="profile-page" style="display: none;">
    <div id="badges">
      <div id="badge1" class="badge"><span>Badge 1</span></div>
      <div id="badge2" class="badge"><span>Badge 2</span></div>
      <div id="badge3" class="badge"><span>Badge 3</span></div>
    </div>

    <div id="profile-section">
      <h3>Set Your Profile Name</h3>
      <input type="text" id="profileNameInput" placeholder="Your name..." />
      <button onclick="saveProfileName()">Save</button>
      <p id="savedProfileName">Saved Name: -</p>
    </div>
  </section>

  <section id="mint">
    <h2>Mint Section</h2>
    <div class="mint-card-container">
      <div class="mint-card">
        <div data-widget="highlight-mint-card" data-mint-collection-id="687c37d010dbc9335fa31a05" data-theme='{"bgColor":"#000000","textColor":"#ffffff","accentColor":"#66ff00"}'></div>
      </div>
      <div class="mint-card">
        <div data-widget="highlight-mint-card" data-mint-collection-id="6883c6d3ec207499979a1de6" data-theme='{"bgColor":"#000000","textColor":"#ffffff","accentColor":"#66ff00"}'></div>
      </div>
    </div>
  </section>

  <section id="artists">
    <h2>Our Artists</h2>
    <p>Rick Starr, DJ and Soundengineer</p>
    <p>NaNa The Ape, Founder of the Mutant Records Collective</p>
  </section>

  <section id="team">
    <h2>Meet the Team</h2>
    <div class="team-container">
      <div class="team-member">
        <img src="nanatheape.jpg" alt="NaNa The Ape" />
        <h3>NaNa The Ape</h3>
        <p>DJ, Producer & Founder</p>
      </div>
      <div class="team-member">
        <img src="rickstarr.jpg" alt="Rick Starr" />
        <h3>Rick Starr</h3>
        <p>Sound Engineer, DJ</p>
      </div>
      <div class="team-member">
        <img src="shanananft.jpg" alt="$Shanananft" />
        <h3>$Shanananft</h3>
        <p>Musician & 3D Animator</p>
      </div>
    </div>
  </section>

  <section id="impressum">
    <h2>Imprint</h2>
    <p>Legal disclosure and contact information will go here.</p>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
  <script>
    const badgeContracts = {
      badge1: "0xed10cd2183de930c70c812d237d5ee763a9bbc52",
      badge2: "0xdfa50db2aa335e8ccd0671ca11abce7938a3ec09",
      badge3: "0xdfa50db2aa335e8ccd0671ca11abce7938a3ec09",
    };

    const abi = ["function balanceOf(address owner) view returns (uint256)"];
    const APECHAIN_PARAMS = {
      chainId: "0x50A",
      chainName: "ApeChain",
      nativeCurrency: { name: "APE", symbol: "APE", decimals: 18 },
      rpcUrls: ["https://rpc.apexape.io"],
      blockExplorerUrls: ["https://apescan.io"]
    };

    let signer;
    let userAddress;

    document.getElementById("connectWalletBtn").addEventListener("click", async () => {
      try {
        if (!window.ethereum) {
          alert("MetaMask is not installed. Please install it.");
          return;
        }

        await switchToApeChain();

        const provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        userAddress = await signer.getAddress();

        const message = "Login to Mutant Records with your wallet.";
        await signer.signMessage(message);

        document.getElementById("walletAddress").innerText = `Connected: ${userAddress}`;
        document.getElementById("profile-page").style.display = "block";

        await checkNFTBadges(userAddress);
        loadProfileName();
      } catch (err) {
        console.error("Connection failed:", err);
        alert("Wallet connection failed.");
      }
    });

    async function switchToApeChain() {
      try {
        await window.ethereum.request({
          method: "wallet_switchEthereumChain",
          params: [{ chainId: APECHAIN_PARAMS.chainId }],
        });
      } catch (switchError) {
        if (switchError.code === 4902) {
          try {
            await window.ethereum.request({
              method: "wallet_addEthereumChain",
              params: [APECHAIN_PARAMS],
            });
          } catch (addError) {
            throw new Error("Failed to add ApeChain");
          }
        } else {
          throw new Error("User rejected network switch");
        }
      }
    }

    async function checkNFTBadges(wallet) {
      const provider = new ethers.providers.JsonRpcProvider(APECHAIN_PARAMS.rpcUrls[0]);

      for (const [badgeId, contractAddr] of Object.entries(badgeContracts)) {
        try {
          const contract = new ethers.Contract(contractAddr, abi, provider);
          const balance = await contract.balanceOf(wallet);
          const badgeElem = document.getElementById(badgeId);

          if (balance.gt(0)) {
            badgeElem.classList.add("owned");
            badgeElem.innerHTML = `<span>${badgeId.toUpperCase()}<br>âœ” Owned</span>`;
          } else {
            badgeElem.classList.remove("owned");
            badgeElem.innerHTML = `<span>${badgeId.toUpperCase()}</span>`;
          }
        } catch (err) {
          console.error(`Error checking ${badgeId}:`, err);
        }
      }
    }

    function saveProfileName() {
      const name = document.getElementById("profileNameInput").value;
      if (!userAddress) {
        alert("Connect your wallet first.");
        return;
      }
      localStorage.setItem(`profile_${userAddress}`, name);
      document.getElementById("savedProfileName").innerText = `Saved Name: ${name}`;
    }

    function loadProfileName() {
      if (!userAddress) return;
      const saved = localStorage.getItem(`profile_${userAddress}`);
      if (saved) {
        document.getElementById("savedProfileName").innerText = `Saved Name: ${saved}`;
      }
    }
  </script>
</body>
</html>



